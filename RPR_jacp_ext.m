function Jep = RPR_jacp_ext(Q,Qp,L,G)

    q1 = Q(1); %R
    q2 = Q(2); %P
    q3 = Q(3); %R
    qp1 = Qp(1); %R
    qp2 = Qp(2); %P
    qp3 = Qp(3); %R
    l1 = L(1);
    l2 = L(2);
    l3 = L(3);
    l4 = L(4);
    l5 = L(5);
    g1 = G(1);
    g2 = G(2);
    g3 = G(3);
    g4 = G(4);
    g5 = G(5);

    Jep=zeros(18,3);
    Jep(1,1) = -l2*cos(q1)*qp1+sin(q1)*qp1*(l3+q2+l5*cos(q3))-cos(q1)*(qp2-l5*qp3*sin(q3));  
    Jep(1,2) = -cos(q1)*qp1;
    Jep(1,3) = l5*qp1*cos(q1)*sin(q3)+l5*sin(q1)*qp3*cos(q3);
    Jep(2,1) = -l2*sin(q1)*qp1-cos(q1)*qp1*(l3+q2+l5*cos(q3))-sin(q1)*(qp2-l5*qp3*sin(q3)); 
    Jep(2,2) = -sin(q1)*qp1; 
    Jep(2,3) = l5*sin(q3)*qp1*sin(q1)-l5*cos(q3)*qp3*cos(q1);
    Jep(3,1) = 0;
    Jep(3,2) = 0;
    Jep(3,3) = -l5*sin(q3)*qp3;
    Jep(4,1) = -l2*cos(q1)*qp1+sin(q1)*qp1*(l3+q2+g5*cos(q3))-cos(q1)*(qp2-g5*qp3*sin(q3));  
    Jep(4,2) = -cos(q1)*qp1;
    Jep(4,3) = g5*qp1*cos(q1)*sin(q3)+g5*sin(q1)*qp3*cos(q3);
    Jep(5,1) = -l2*sin(q1)*qp1-cos(q1)*qp1*(l3+q2+g5*cos(q3))-sin(q1)*(qp2-g5*qp3*sin(q3));
    Jep(5,2) = -sin(q1)*qp1;
    Jep(5,3) = g5*sin(q3)*qp1*sin(q1)-g5*cos(q3)*qp3*cos(q1);
    Jep(6,1) = 0;
    Jep(6,2) = 0;
    Jep(6,3) = -g5*sin(q3)*qp3;
    Jep(7,1) = -l2*cos(q1)*qp1+sin(q1)*qp1*(l3+q2-(l4-g4))-cos(q1)*qp2;  
    Jep(7,2) = -cos(q1)*qp1;
    Jep(7,3) = 0;
    Jep(8,1) = -l2*sin(q1)*qp1-cos(q1)*qp1*(l3+q2-(l4-g4))-sin(q1)*qp2;
    Jep(8,2) = -sin(q1)*qp1;
    Jep(8,3) = 0;
    Jep(9,1) = 0;
    Jep(9,2) = 0;
    Jep(9,3) = 0;
    Jep(10,1) = -l2*cos(q1)*qp1+sin(q1)*qp1*g3;   
    Jep(10,2) = 0;
    Jep(10,3) = 0;
    Jep(11,1) = -l2*sin(q1)*qp1-cos(q1)*qp1*g3;
    Jep(11,2) = 0;
    Jep(11,3) = 0;
    Jep(12,1) = 0;
    Jep(12,2) = 0;
    Jep(12,3) = 0;
    Jep(13,1) = -g2*cos(q1)*qp1;  
    Jep(13,2) = 0;
    Jep(13,3) = 0;
    Jep(14,1) = -g2*sin(q1)*qp1;
    Jep(14,2) = 0;
    Jep(14,3) = 0;
    Jep(15,1) = 0;
    Jep(15,2) = 0;
    Jep(15,3) = 0;
    Jep(16,1) = 0;   
    Jep(16,2) = 0;
    Jep(16,3) = 0;
    Jep(17,1) = 0;
    Jep(17,2) = 0;
    Jep(17,3) = 0;
    Jep(18,1) = 0;
    Jep(18,2) = 0;
    Jep(18,3) = 0;

end

