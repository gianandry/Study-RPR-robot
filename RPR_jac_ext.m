function Je = RPR_jac_ext(Q,L,G)
    
    q1 = Q(1); %R
    q2 = Q(2); %P
    q3 = Q(3); %R
    l1 = L(1);
    l2 = L(2);
    l3 = L(3);
    l4 = L(4);
    l5 = L(5);
    g1 = G(1);
    g2 = G(2);
    g3 = G(3);
    g4 = G(4);
    g5 = G(5);

    Je=zeros(18,3);
    Je(1,1) = -l2*sin(q1)-(l3+q2+l5*cos(q3))*cos(q1);   
    Je(1,2) = -sin(q1);
    Je(1,3) = l5*sin(q1)*sin(q3);
    Je(2,1) = l2*cos(q1)-(l3+q2+l5*cos(q3))*sin(q1);
    Je(2,2) = cos(q1);
    Je(2,3) = -l5*cos(q1)*sin(q3);
    Je(3,1) = 0;
    Je(3,2) = 0;
    Je(3,3) = l5*cos(q3);
    Je(4,1) = -l2*sin(q1)-(l3+q2+g5*cos(q3))*cos(q1);   
    Je(4,2) = -sin(q1);
    Je(4,3) = g5*sin(q1)*sin(q3);
    Je(5,1) = l2*cos(q1)-(l3+q2+g5*cos(q3))*sin(q1);
    Je(5,2) = cos(q1);
    Je(5,3) = -g5*cos(q1)*sin(q3);
    Je(6,1) = 0;
    Je(6,2) = 0;
    Je(6,3) = g5*cos(q3);
    Je(7,1) = -l2*sin(q1)-(l3+q2-(l4-g4))*cos(q1);   
    Je(7,2) = -sin(q1);
    Je(7,3) = 0;
    Je(8,1) = l2*cos(q1)-(l3+q2-(l4-g4))*sin(q1);
    Je(8,2) = cos(q1);
    Je(8,3) = 0;
    Je(9,1) = 0;
    Je(9,2) = 0;
    Je(9,3) = 0;
    Je(10,1) = -l2*sin(q1)-g3*cos(q1);   
    Je(10,2) = 0;
    Je(10,3) = 0;
    Je(11,1) = l2*cos(q1)-g3*sin(q1);
    Je(11,2) = 0;
    Je(11,3) = 0;
    Je(12,1) = 0;
    Je(12,2) = 0;
    Je(12,3) = 0;
    Je(13,1) = -g2*sin(q1);   
    Je(13,2) = 0;
    Je(13,3) = 0;
    Je(14,1) = g2*cos(q1);
    Je(14,2) = 0;
    Je(14,3) = 0;
    Je(15,1) = 0;
    Je(15,2) = 0;
    Je(15,3) = 0;
    Je(16,1) = 1;   
    Je(16,2) = 0;
    Je(16,3) = 0;
    Je(17,1) = 1;
    Je(17,2) = 0;
    Je(17,3) = 0;
    Je(18,1) = 0;
    Je(18,2) = 0;
    Je(18,3) = 1;
    
end

